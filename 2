Add-Type -AssemblyName PresentationCore
Add-Type -AssemblyName System.Speech
Add-Type -AssemblyName Microsoft.VisualBasic

# Hide Console Window
Add-Type -Name Win -Namespace H -MemberDefinition '
  [DllImport("kernel32.dll")]public static extern IntPtr GetConsoleWindow();
  [DllImport("user32.dll")]public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);'
$consolePtr = [H.Win]::GetConsoleWindow()
[H.Win]::ShowWindow($consolePtr, 0)

# Text To Speech Init
$speak = New-Object System.Speech.Synthesis.SpeechSynthesizer
$speak.Rate = -2
$speak.SelectVoice('Microsoft Zira Desktop')

# Scary Speech Sequence
$speak.Speak("WARNING. Unauthorized activity detected.")
Start-Sleep -Milliseconds 800
$speak.Speak("System lockdown commencing in three two one...")
Start-Sleep -Milliseconds 1000

# Keyboard light flickering (Scroll lock)
for ($i = 0; $i -lt 5; $i++) {
    (New-Object -ComObject WScript.Shell).SendKeys("{SCROLLLOCK}")
    Start-Sleep -Milliseconds 300
}

# Fake terminal format output
Write-Host "`e[91mInitiating programmatic wipe..." -ForegroundColor Red
for ($i=0; $i -le 100; $i+=4) {
    Write-Host -NoNewline "$i% "
    Start-Sleep -Milliseconds 80
}
Write-Host "`n`e[92mDrive formatted successfully."

# Mouse freeze simulation (lock in place)
Add-Type @"
using System;
using System.Runtime.InteropServices;
public class Cursor {
    [DllImport("user32.dll")]
    public static extern bool SetCursorPos(int X, int Y);
}
"@
for ($j=0; $j -lt 20; $j++) {
    [Cursor]::SetCursorPos(800, 500)
    Start-Sleep -Milliseconds 80
}

# Open Camera App (light turns on)
Start-Process "microsoft.windows.camera:"
Start-Sleep -Seconds 1
$speak.Speak("We see you...")

# Change Desktop Wallpaper (creepy optional twist)
$path = "$env:TEMP\you_are_not_safe.jpg"
Invoke-WebRequest "https://i.imgur.com/qD429oF.jpg" -OutFile $path -UseBasicParsing
Add-Type @"
using System.Runtime.InteropServices;
public class Wallpaper {
  [DllImport("user32.dll", SetLastError=true)]
  public static extern bool SystemParametersInfo(int uAction, int uParam, string lpvParam, int fuWinIni);
}
"@
[Wallpaper]::SystemParametersInfo(20, 0, $path, 3)

# Final Scary TTS Line
$speak.Speak("Just kidding. You are safe, for now.")

# Play default Windows sound
Add-Type -AssemblyName System.Media
$player = New-Object System.Media.SoundPlayer
$player.SoundLocation = "$env:windir\Media\Windows Foreground.wav"
$player.PlaySync()

# Message Box saying it's a prank
[Microsoft.VisualBasic.Interaction]::MsgBox("Chill. Itâ€™s just a prank. No system changes made. - v1r_s.ps1", "OKOnly,Info", "ðŸ˜¼ Gotcha")
